<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Docker bind Mounts和volume及tmpfs对比 - Tomial's Blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:image" content><meta property="og:title" content="Docker bind Mounts和volume及tmpfs对比"><meta property="og:description" content="本文总结了 bind Mounts 和 volume 及 tmpfs 三种 Docker 管理容器数据方式的区别"><meta property="og:type" content="article"><meta property="og:url" content="https://tomial.github.io/posts/docker-bind-mounts%E5%92%8Cvolume%E5%8F%8Atmpfs%E5%AF%B9%E6%AF%94/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-04-10T17:37:28+08:00"><meta property="article:modified_time" content="2021-04-10T17:37:28+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Docker bind Mounts和volume及tmpfs对比"><meta name=twitter:description content="本文总结了 bind Mounts 和 volume 及 tmpfs 三种 Docker 管理容器数据方式的区别"><script src=https://tomial.github.io/js/feather.min.js></script><link href=https://tomial.github.io/css/fonts.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://tomial.github.io/css/main.css></head><body><div class=content><header><div class=main><a href=https://tomial.github.io/>Tomial's Blog</a></div><nav><a href=/>主页</a>
<a href=/posts>全部文章</a>
<a href=/tags>标签</a>
<a href=/about>关于</a></nav></header><main><article><div class=title><h1 class=title>Docker bind Mounts和volume及tmpfs对比</h1><div class=meta style=margin-bottom:3em>最后编辑于 2021-04-10</div></div><section class=body><p>本文总结了 bind Mounts 和 volume 及 tmpfs 三种 Docker 管理容器数据方式的区别</p><h1 id=bind-mounts>bind mounts</h1><p>根据官方文档的介绍：</p><blockquote><p>bind mounts have limited functionality compared to volumes. <strong>When you use a bind mount, a file or directory on the host machine is mounted into a container. The file or directory is referenced by its absolute path on the host machine.</strong> By contrast, when you use a volume, a new directory is created within Docker&rsquo;s storage directory on the host machine, and Docker manages that directory&rsquo;s contents.</p></blockquote><p><code>bind mounts</code>相比<code>volume</code>功能较为有限，创建一个 bind mount 之后，Host 上的一个文件/文件夹就相当于被挂载到容器里了，该文件/文件夹就被容器通过绝对路径引用了，<strong>意味着这个文件/文件夹必须实现存在于 Host 上</strong>。</p><p>而使用使用<code>volume</code>时，会在 Host 主机上新建一个<strong>Docker 存储文件夹</strong>，文件夹里的内容由 Docker 管理。</p><blockquote><p>The file or directory does not need to exist on the Docker host already. It is created on demand if it does not yet exist. bind mounts are very performant, but they rely on the host machine’s filesystem having a specific directory structure available. If you are developing new Docker applications, consider using named volumes instead.</p></blockquote><p><code>volume</code>映射的文件/文件夹不需要存在于 Host 上，它们是按需生成的，即可以被自动创建，不需要实现在 Host 上创建。</p><p><strong>虽然<code>bind mounts</code>很高效，但是它依赖 Host 上存在特定的目录结构</strong>，这对于部署到新主机上显然不是一件好事，所以推荐新应用使用<code>volume</code>。</p><h1 id=volume>volume</h1><blockquote><p>Volumes are the preferred mechanism for persisting data generated by and used by Docker containers. While bind mounts are dependent on the directory structure and OS of the host machine, volumes are completely managed by Docker.</p></blockquote><p><code>volume</code>与<code>bind mounts</code>的区别在于后者依赖于 Host 上有特定的目录结构，而前者不需要，使用 volume 时文件的管理由 Docker 主导而不是 Host。</p><p>文档还提到了<code>volume</code>相比于<code>bind mounts</code>的优点：</p><ul><li><strong>更易于备份/转移</strong></li><li>同时可用于 Linux/Windows 容器</li><li>在多个容器间共享更安全</li><li><strong><code>volume</code>驱动能够让你在远程主机或云服务器上存储<code>volume</code>，还能实现数据加密等功能</strong></li><li>新容器可以提前填充内容到<code>volume</code>里</li><li>在 Mac 和 Windows 主机里<code>volume</code>性能比<code>bind mounts</code>好的多</li></ul><p>若容器产生的数据不需要持久化，可以考虑使用<code>tmpfs</code>来避免持久化数据和写入容器层(writable layer)，从而提高性能</p><h1 id=tmpfs>tmpfs</h1><p><code>tmpfs</code>是将文件写到内存中，可以避免写数据到容器层增加容器大小。</p><p>但<code>tmpfs</code>有两个缺点：</p><ul><li>只能在 Linux Host 上使用</li><li>不能在多个容器间共享</li></ul><p>下图解释了三者的关系：
<img src=./1.png alt="bind-mounts volume tmpfs"></p><h1 id=参考资料>参考资料：</h1><p><a href=https://docs.docker.com/storage/bind-mounts/>Use bind mounts</a>
<a href=https://docs.docker.com/storage/volumes/>Use volumes</a>
<a href=https://docs.docker.com/storage/tmpfs/>Use tmpfs mounts</a></p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/docker>Docker</a></li></ul></nav></div></article></main><footer><hr><a class=soc href=https://github.com/tomial title=Github><i data-feather=github></i></a>|⚡️
2021 © Tomial | Modified <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></footer><script>feather.replace()</script></div></body></html>